#!/usr/bin/env bash

DEST_BASE_DIR="../_site/"

# build data
mkdir -p web/data
cp bin/charts.js web/data/
bin/csv2json history.csv web/data/dataset.json

# build web
cd web
git pull origin
npm run build

# copy resource
cp index.html $DEST_BASE_DIR
cp bundle.js $DEST_BASE_DIR
cp -r css $DEST_BASE_DIR
cp -r data $DEST_BASE_DIR

# push to github
cd $DEST_BASE_DIR
git add .
git commit -m "update site"
git push origin master:gh-pages